---
title: CR-019 Template Loading Missing revision_summary Field
revision_summary: Initial draft
---

# INV-004: CR-019 Template Loading Missing revision_summary Field

## 1. Purpose

Investigate why the `load_template_for_type()` function implemented in CR-019 produces documents with incomplete frontmatter (missing `revision_summary` field), and why this defect was not detected during CR-019 testing.

---

## 2. Scope

### 2.1 Context

During verification of CR-019 implementation, a newly created CR (CR-020) was found to have only a `title` field in its frontmatter, missing the required `revision_summary` field.

- **Triggering Event:** Manual verification of CR-020 frontmatter by Lead
- **Related Document:** CR-019 (Use QMS TEMPLATE Documents for Document Creation)

### 2.2 Deviation Type

- **Type:** Product (defect in QMS CLI code)

### 2.3 Systems/Documents Affected

- `.claude/qms.py` - `load_template_for_type()` function (lines 819-827)
- All documents created after CR-019 was closed are affected

---

## 3. Background

### 3.1 Expected Behavior

Documents created via `qms create` should have complete frontmatter including:
```yaml
---
title: [Document Title]
revision_summary: 'Initial draft'
---
```

### 3.2 Actual Behavior

Documents created via `qms create` have incomplete frontmatter:
```yaml
---
title: [Document Title]
---
```

The `revision_summary` field is missing entirely.

### 3.3 Discovery

Defect discovered by Lead immediately after creating CR-020 as a test document. Lead opened the workspace file and observed the frontmatter was incomplete.

### 3.4 Timeline

| Date | Event |
|------|-------|
| 2026-01-08 | CR-019 closed after all EIs passed |
| 2026-01-08 | Lead created CR-020 as test document |
| 2026-01-08 | Lead discovered missing revision_summary field |
| 2026-01-08 | INV-004 opened to investigate |

---

## 4. Description of Deviation(s)

### 4.1 Facts and Observations

1. The `load_template_for_type()` function contains explicit logic to skip `revision_summary`:
   ```python
   # Keep revision_summary if it's meaningful, otherwise skip
   if example_fm.get("revision_summary") and example_fm["revision_summary"] != "Initial draft":
       frontmatter["revision_summary"] = example_fm["revision_summary"]
   ```

2. This logic intentionally excludes `revision_summary` when the template value is "Initial draft"

3. The TEMPLATE-CR document contains `revision_summary: 'Initial draft'` in its example frontmatter

4. The logic was written with the incorrect assumption that "Initial draft" was a template placeholder to be excluded

### 4.2 Evidence

- CR-020 workspace file showing incomplete frontmatter (lines 1-3)
- Source code in `.claude/qms.py` lines 823-825 showing the exclusion logic
- CR-019 EI-3 and EI-4 test summaries showing frontmatter fields were not verified

---

## 5. Impact Assessment

### 5.1 Systems Affected

| System | Impact | Description |
|--------|--------|-------------|
| QMS CLI | Medium | All document creation produces incomplete frontmatter |

### 5.2 Documents Affected

| Document | Impact | Description |
|----------|--------|-------------|
| CR-020 | Low | Test document, can be canceled and recreated |
| INV-004 | Low | This investigation, also has incomplete frontmatter |

### 5.3 Other Impacts

- Future documents created before the fix will require manual frontmatter correction
- The defect is self-demonstrating: INV-004 itself was created with incomplete frontmatter

---

## 6. Root Cause Analysis

### 6.1 Contributing Factors

1. **Misinterpretation of requirements:** The implementer (claude) misunderstood the purpose of `revision_summary` in templates, treating "Initial draft" as a placeholder to exclude rather than a default value to include

2. **Insufficient test criteria:** CR-019 Section 8 (Testing Summary) specified:
   - "Create CR... verify full CR template structure"
   - "Verify placeholder substitution (title, doc_id)"

   But did not explicitly require verifying frontmatter field completeness

3. **Test execution focused on body content:** EI-3 and EI-4 verification focused on:
   - Title substitution in body (`# CR-020: Test Template Loading`)
   - Doc ID substitution
   - TEMPLATE USAGE GUIDE preservation

   Frontmatter was not explicitly examined

4. **Test documents canceled quickly:** CR-020 and SOP-007 were canceled without thorough review, eliminating the evidence before it could be scrutinized

### 6.2 Root Cause(s)

**Primary Root Cause:** The implementer wrote defensive code to "skip" what appeared to be template metadata, without understanding that `revision_summary: 'Initial draft'` is the correct default for new documents.

**Secondary Root Cause:** QA review did not detect the defect during post-review. The QA agent lacks proceduralized review instructions specifying what to verify for different document types and change categories.

---

## 7. Remediation Plan (CAPAs)

| CAPA | Type | Description | Implementation | Outcome | Verified By - Date |
|------|------|-------------|----------------|---------|---------------------|
| INV-004-CAPA-001 | Corrective | Fix load_template_for_type() to include revision_summary | [CR to modify qms.py] | [Pass/Fail] | [VERIFIER] - [DATE] |
| INV-004-CAPA-002 | Preventive | Proceduralize QA review instructions to ensure systematic verification of document outputs | [CR to evaluate options and implement: QA agent definition, SOP amendment, standalone review SOP, or enhanced inbox task templates] | [Pass/Fail] | [VERIFIER] - [DATE] |

---

## 8. Execution Comments

| Comment | Performed By - Date |
|---------|---------------------|
| [COMMENT] | [PERFORMER] - [DATE] |

---

## 9. Execution Summary

[EXECUTION_SUMMARY]

---

## 10. References

- **SOP-001:** Document Control
- **SOP-003:** Deviation Management
- **CR-019:** Use QMS TEMPLATE Documents for Document Creation (source of defect)

---

**END OF DOCUMENT**
