---
title: Executable Document Checkout Workflow Gaps
revision_summary: Simplified scope; finalized versioning model
---

# INV-007: Executable Document Checkout Workflow Gaps

## 1. Purpose

Investigate workflow gaps in the checkout command behavior for executable documents at specific workflow states. The current implementation does not provide intuitive state transitions when checking out documents in PRE_APPROVED or POST_REVIEWED status.

---

## 2. Scope

### 2.1 Context

During preparation for CR-043 execution, scope changes were identified after pre-approval. Attempting to revise the document revealed that the workflow does not support reverting PRE_APPROVED documents to DRAFT for re-review. Further analysis identified a similar gap for POST_REVIEWED documents.

- **Triggering Event:** CR-043 scope change attempt after pre-approval
- **Related Document:** CR-043

### 2.2 Deviation Type

- **Type:** Procedural

### 2.3 Systems/Documents Affected

- `SDLC-QMS-RS` - Requirements Specification (checkout behavior requirements)
- `qms-cli` - CLI implementation of checkout command

---

## 3. Background

### 3.1 Expected Behavior

In GMP document control systems, the checkout command triggers state transitions appropriate to the document's current workflow position:

| Status | Expected Checkout Behavior |
|--------|----------------------------|
| PRE_APPROVED | Revert to DRAFT for re-review before execution |
| POST_REVIEWED | Return to IN_EXECUTION for continued execution work |

### 3.2 Current QMS Behavior

| Status | Current Behavior | Gap |
|--------|------------------|-----|
| PRE_APPROVED | Copy to workspace only; status unchanged | No path to DRAFT for re-review |
| POST_REVIEWED | Copy to workspace; checkin reverts to DRAFT | Unnecessary DRAFT intermediate state |

### 3.3 Discovery Timeline

| Date | Event |
|------|-------|
| 2026-02-01 | CR-043 pre-approved; scope gaps identified |
| 2026-02-01 | Attempted checkout/checkin cycle to trigger re-review |
| 2026-02-01 | Discovered PRE_APPROVED does not revert on checkout or checkin |
| 2026-02-02 | Analysis expanded to include POST_REVIEWED gap |

---

## 4. Description of Deviation(s)

### 4.1 Deviation 1: PRE_APPROVED Checkout

**Facts:**
- Checkout from PRE_APPROVED copies document to workspace without status change
- Checkin from PRE_APPROVED preserves PRE_APPROVED status
- No workflow path exists to return PRE_APPROVED to DRAFT for re-review
- Current workarounds: cancel/recreate (loses history), VAR during execution (overhead)

### 4.2 Deviation 2: POST_REVIEWED Checkout

**Facts:**
- Checkout from POST_REVIEWED copies to workspace without status change
- Checkin from POST_REVIEWED reverts status to DRAFT
- Routing from DRAFT (with post_release phase) goes to IN_POST_REVIEW
- The DRAFT intermediate state is unnecessary; document should return directly to IN_EXECUTION
- A separate `revert` command exists but is redundant with enhanced checkout

### 4.3 Evidence

- SDLC-QMS-RS v6.0: No requirements define checkout state transitions for PRE_APPROVED or POST_REVIEWED
- qms-cli checkout.py: Status-agnostic implementation (copy to workspace only)
- qms_meta.py update_meta_checkin(): POST_REVIEWED triggers DRAFT reversion rather than IN_EXECUTION

---

## 5. Impact Assessment

### 5.1 Systems Affected

| System | Impact | Description |
|--------|--------|-------------|
| QMS Workflow | Medium | No clean path to revise PRE_APPROVED documents or continue POST_REVIEWED execution |

### 5.2 Documents Affected

| Document | Impact | Description |
|----------|--------|-------------|
| Any PRE_APPROVED executable | Medium | Cannot revise scope before execution |
| Any POST_REVIEWED executable | Low | Workaround exists (revert command) but unintuitive |

### 5.3 Other Impacts

- **Command complexity:** The `revert` command is a niche workflow that checkout could handle
- **User experience:** Inconsistent behavior across workflow states

---

## 6. Root Cause Analysis

### 6.1 Root Cause

The checkout command was designed as a status-agnostic operation (copy document to workspace). GMP best practice is for checkout to trigger appropriate state transitions based on the document's current workflow position. The requirements specification did not define checkout behavior for PRE_APPROVED or POST_REVIEWED states.

### 6.2 Contributing Factors

1. Initial requirements focused on the happy path (document flows forward through states)
2. Checkout was conceived as a simple "copy to edit" operation
3. The `revert` command was added as a point solution rather than addressing the underlying checkout design

---

## 7. Remediation Plan (CAPAs)

| CAPA | Type | Description | Implementation | Outcome | Verified By - Date |
|------|------|-------------|----------------|---------|---------------------|
| CAPA-001 | Corrective | Create CR to implement status-aware checkout behavior for PRE_APPROVED and POST_REVIEWED states, and requalify qms-cli | [CR_ID] | [Pass/Fail] | [VERIFIER] - [DATE] |

### 7.1 Proposed Requirements

**REQ-WF-016: Pre-Release Revision**
When a document in PRE_APPROVED status is checked out, the CLI shall transition the document to DRAFT status and clear all pre-review/pre-approval tracking fields. This allows scope revision through re-review before execution begins.

**REQ-WF-017: Post-Review Continuation**
When a document in POST_REVIEWED status is checked out, the CLI shall transition the document to IN_EXECUTION status at the same version, allowing continued execution work without an intermediate DRAFT state.

---

## 8. Execution Comments

| Comment | Performed By - Date |
|---------|---------------------|
| [COMMENT] | [PERFORMER] - [DATE] |

---

## 9. Execution Summary

[EXECUTION_SUMMARY]

---

## 10. References

- **SOP-001:** Document Control
- **SOP-003:** Deviation Management
- **SDLC-QMS-RS:** QMS CLI Requirements Specification
- **CR-043:** Implement Containerized Claude Agent Infrastructure (triggering document)

---

**END OF DOCUMENT**
