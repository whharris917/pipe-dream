---
title: Document Execution
revision_summary: 'CR-091: Add Section 11 (Interactive Document Authoring) for template-driven
  VR authoring; cross-reference Section 9C to Section 11'
---

# SOP-004: Document Execution

---

## 1. Purpose

This Standard Operating Procedure (SOP) governs the execution phase of all executable documents, including scope management, progress tracking, and evidence requirements.

---

## 2. Scope

This SOP applies to the execution phase of:

- Change Records (CR)
- Investigations (INV)
- Test Protocols (TP)
- Exception Reports (ER)
- Variance Reports (VAR)
- Addendum Reports (ADD)
- Verification Records (VR)

Note: CAPAs are not standalone documents; they are execution items within INVs (see SOP-003).

---

## 3. Definitions

| Term | Definition |
|------|------------|
| **Executable Document** | A document that authorizes implementation activities (CR, INV, TP, ER, VAR, ADD, VR) |
| **Executable Block** | Section of an executable document where implementation work is recorded |
| **Execution Item (EI)** | Discrete unit of work within the executable block |
| **Evidence** | Documentation proving completion of an execution item |
| **Static Field** | A field in the executable block that is defined at document creation and is never editable (e.g., test step instructions) |
| **Editable Field** | A field in the executable block where execution work is recorded (e.g., execution details, evidence) |

---

## 4. The Executable Block

### 4.1 Structure

The executable block is located after pre-approved content (Purpose, Scope, Rationale, Plan) in an executable document.

The executable block contains:
- **Static fields:** Defined at document creation; never editable (e.g., test step instructions, task descriptions)
- **Editable fields:** Where execution work is recorded (e.g., execution summary, task outcome, signature)

### 4.2 Execution Item Table

Execution items are tracked in table format with the following columns:

| Column | Type | Description |
|--------|------|-------------|
| **EI** | Static | Execution item identifier |
| **Task Description** | Static | What the item accomplishes |
| **VR** | Static/Editable | "Yes" if VR required (static, set during planning); VR ID when created (editable, filled during execution). Blank if no VR required. See Section 9C. |
| **Execution Summary** | Editable | Narrative of work performed, evidence, observations |
| **Task Outcome** | Editable | Pass or Fail |
| **Performed By — Date** | Editable | Signature of executor with date |

**Task Outcome Values:**

| Outcome | Meaning |
|---------|---------|
| **Pass** | Task completed as planned |
| **Fail** | Task could not be completed as planned; requires VAR or ER |

If a task outcome is Fail, the executor must attach a Variance Report (VAR) for non-test documents or Exception Report (ER) for test documents explaining why the task failed and how the situation will be resolved.

---

## 5. Document States During Execution

The executable block's editable fields change state as the document progresses:

| State | Executable Block (Editable Fields) | Pre-Approved Content |
|-------|-------------------------------------|---------------------|
| **PRE_APPROVED** | Blank and locked | Locked |
| **IN_EXECUTION** | Editable | Locked |
| **POST_REVIEWED** | Editable (during review cycles) | Locked |
| **CLOSED** | Sealed | Sealed |

Note: The executable block structure (static fields) exists from document creation. Only the editable fields change state as described above.

After releasing an executable document for execution (transitioning from PRE_APPROVED to IN_EXECUTION), the initiator shall commit and push the project repository and all submodules as the first execution item. This preserves the pre-execution baseline -- the pre-approved document content, routing history, and approval records -- in version control before implementation work begins. The commit hash shall be recorded in EI-1's execution summary.

As the final execution item, before routing for post-review, the initiator shall commit and push the project repository and all submodules. This captures the post-execution state -- implementation artifacts, execution evidence, and updated documents. The commit hash shall be recorded in the final EI's execution summary.

---

## 6. Scope Integrity

Pre-approved scope items must be completed. This is a key lesson from INV-001.

### 6.1 Handling Obstacles

If obstacles arise during execution:

1. **Complete the item as planned**, OR
2. **Document an exception** via VAR (for non-test documents) or ER (for test documents) with rationale explaining why the item cannot be completed and how the situation will be resolved

### 6.2 Critical Principle

"Different execution mechanism" is NOT a scope exclusion. If scope was approved, it must be addressed.

Scope items cannot be silently dropped. If an item cannot be completed as originally planned, this must be formally documented with clear rationale and resolution path.

---

## 7. Execution Outcome Documentation

### 7.1 Recording Outcomes

As each execution item is completed, the executor shall:

1. Record a narrative of work performed in the **Execution Summary** column
2. Mark the **Task Outcome** as Pass or Fail
3. Sign with **Performed By — Date**

### 7.2 Pass Outcomes

A Pass outcome indicates the task was completed as planned. The Execution Summary should contain sufficient evidence to demonstrate completion, such as:
- Commit hashes (for code changes)
- Document IDs (for document creation/updates)
- Test results (for testing activities)
- Other verifiable artifacts appropriate to the task

### 7.3 Fail Outcomes

A Fail outcome indicates the task could not be completed as planned. When marking Fail:

1. Document what occurred in the Execution Summary
2. Attach a VAR (for non-test documents) or ER (for test documents) with:
   - Detailed description of the issue
   - Root cause analysis
   - Resolution plan or disposition

---

## 8. Evidence Requirements

### 8.1 Evidence in Execution Summary

Each Pass execution item requires documented evidence in the Execution Summary column. Evidence demonstrates that the work was performed and the objective was achieved.

### 8.2 Evidence Types

Acceptable evidence includes:
- Commit hash (for code changes)
- Document ID (for document creation/updates)
- Test result (for testing activities)
- Screenshot (for visual verification)
- Other verifiable artifacts appropriate to the execution item

### 8.3 Fail Items

Fail items require:
- Explanation of what occurred in the Execution Summary
- Attached VAR (for non-test) or ER (for test) per Sections 9 and 9A

---

## 9. Exception Reports (ER)

Exception Reports (ERs) are used specifically for **test execution failures** within Test Protocols (TPs) and Test Cases (TCs).

### 9.1 ER Scope

ERs apply only to:
- Test step failures (Actual Result does not match Expected Result)
- Test case failures
- Test protocol execution issues

For execution failures in non-test documents (CRs, INVs), use Variance Reports (VARs) per Section 9A.

### 9.2 ER Content

An Exception Report shall contain:
- **Exception Identification:** Parent document, failed item, exception type
- **Detailed Description:** What happened vs. what was expected
- **Root Cause:** Why the failure occurred
- **Proposed Corrective Action:** What action will be taken to address the failure
- **Exception Type:** Test Script Error, Test Execution Error, System Error, Documentation Error, or Other
- **Re-test Section:** Full re-execution of the test case (not just the failed step)
- **ER Closure:** Final outcome and disposition

### 9.3 Re-execution Requirement

When a test step fails:
1. Mark subsequent steps as N/A with ER reference
2. Create an ER containing a full re-execution of the test case
3. Re-execute the entire test within the ER (because the test script itself may be defective)
4. ER closure indicates Pass (all steps pass on re-test) or Fail (further action required)

### 9.4 Nested ERs

If re-execution within an ER fails, create a nested ER (e.g., TP-001-TC-001-ER-001-ER-001).

---

## 9A. Variance Reports (VAR)

Variance Reports (VARs) are used for **execution failures in non-test documents** (CRs, INVs). VARs are blocking child containers that encapsulate resolution work without cluttering the parent document.

### 9A.1 VAR vs ER vs INV

| Document | Use Case | Timing |
|----------|----------|--------|
| **ER** | Test execution failures (TC/TP) | During test execution |
| **VAR** | Non-test execution failures (CR/INV) | During execution of any non-test executable |
| **INV** | Post-hoc quality events, nonconformances | After discovery of quality issue |

**Key Distinction:** VARs handle exceptions encountered *during* execution of a pre-approved plan. INVs (per SOP-003) handle quality events discovered *after* the fact that require formal investigation.

### 9A.2 VAR Types

VARs have two types that govern how they clear the block on their parent document:

| Type | Block Release | Use When |
|------|---------------|----------|
| **Type 1** | Full closure of VAR required | Resolution is critical to parent objectives; parent cannot meaningfully close until fix is proven |
| **Type 2** | Pre-approval of VAR sufficient | Impact is contained; parent's core objectives are met; VAR prevents follow-up from "falling off radar" |

**Type 2 Rationale:** Type 2 VARs enable the parent document to close efficiently while ensuring follow-up work is formally tracked. The VAR provides a dedicated container for work that is logically tied to the parent but would otherwise keep the parent open inefficiently.

### 9A.3 VAR Content

A Variance Report shall contain:
- **Variance Identification:** Parent document, failed item, VAR type
- **Detailed Description:** What happened vs. what was planned
- **Root Cause:** Why the variance occurred
- **Variance Type:** Execution Error, Scope Error, System Error, Documentation Error, External Factor, or Other
- **Impact Assessment:** Effect on parent document objectives
- **Proposed Resolution:** How the variance will be addressed
- **Resolution Work:** Executed work to resolve (uses same EI table structure as parent)
- **VAR Closure:** Final outcome and disposition

When VAR resolution involves code changes, the resolution work should include integration verification -- exercising the fix through user-facing levers in a running system to demonstrate it resolves the variance, not only that automated tests pass.

### 9A.4 VAR Naming

VARs are children of their parent document:

| Parent | VAR ID |
|--------|--------|
| CR-014 | CR-014-VAR-001 |
| INV-003 | INV-003-VAR-001 |
| Nested | CR-014-VAR-001-VAR-001 |

### 9A.5 Scope Handoff

When a VAR is created from a failed execution item, it must explicitly specify:
1. What was successfully accomplished in the parent (before the variance)
2. What the VAR absorbs (takes responsibility for)
3. Confirmation that no scope items were lost in the handoff

If scope is reduced (something from the original plan will not be done), this must be explicitly stated and justified.

---

## 9B. Addendum Reports (ADD)

Addendum Reports (ADDs) are used for **post-closure corrections** to executable documents. ADDs provide a lightweight, formal mechanism to correct or supplement a closed document without requiring a full INV/CAPA cycle.

### 9B.1 ADD vs VAR vs INV

| Document | Use Case | Timing | Parent State |
|----------|----------|--------|--------------|
| **VAR** | Execution failures during active work | During execution | IN_EXECUTION |
| **ADD** | Post-closure corrections or omissions | After closure | CLOSED |
| **INV** | Quality events requiring formal investigation | Any time | Any |

**Key Distinction:** VARs handle exceptions encountered *during* execution. ADDs handle corrections discovered *after* closure. INVs handle quality events requiring formal root cause analysis regardless of timing.

### 9B.2 ADD Content

An Addendum Report shall contain:
- **Addendum Identification:** Parent document, discovery context, scope
- **Description of Omission:** What was omitted, missed, or needs correction
- **Impact Assessment:** Effect on parent document objectives and deliverables
- **Correction Plan:** Execution items needed to complete the correction
- **Execution:** EI table for correction work (editable during execution)
- **Scope Handoff:** Confirmation that nothing was lost between parent and ADD
- **Execution Summary:** Overall outcome

### 9B.3 ADD Naming

ADDs are children of their parent document:

| Parent | ADD ID |
|--------|--------|
| CR-014 | CR-014-ADD-001 |
| INV-003 | INV-003-ADD-001 |
| CR-014-VAR-001 | CR-014-VAR-001-ADD-001 |
| Nested | CR-014-ADD-001-ADD-001 |

### 9B.4 Parent State Requirement

ADDs can only be created against parents in CLOSED state. The CLI enforces this constraint at creation time, rejecting ADD creation when the parent is not CLOSED.

Valid parent types: CR, INV, VAR, ADD. TP and ER are excluded because test-related corrections are handled through their own mechanisms (ER for test failures, nested ERs for re-execution failures).

### 9B.5 Scope Handoff

When an ADD is created, it must explicitly specify:
1. What the parent document accomplished (before closure)
2. What the ADD corrects or supplements
3. Confirmation that no scope items were lost between the parent and the ADD

---

## 9C. Verification Records (VR)

Verification Records (VRs) are **pre-approved evidence forms** for structured behavioral verification. VRs provide auditable evidence that execution items requiring integration testing were verified through observable system behavior.

### 9C.1 VR vs ER vs VAR

| Document | Use Case | Timing |
|----------|----------|--------|
| **VR** | Structured behavioral verification evidence | During execution (positive evidence) |
| **ER** | Test execution failures (TC/TP) | During test execution (negative evidence) |
| **VAR** | Non-test execution failures (CR/INV) | During execution (exception handling) |

**Key Distinction:** VRs record positive evidence that something works correctly. ERs and VARs handle failures. VRs are not created in response to problems — they are planned during document drafting and filled in during execution.

### 9C.2 VR Lifecycle

VRs follow a unique lifecycle: they are born IN_EXECUTION at v1.0 with no pre-review or pre-approval phase. The approved TEMPLATE-VR serves as the pre-approval authority (analogous to pulling a blank batch record off the shelf in a GMP environment).

**Workflow:**
```
create (IN_EXECUTION v1.0, checked out)
  → fill in via interactive authoring (see Section 11)
  → checkin (compiles source to markdown)
  → reviewed as part of parent document's post-review
  → closed when parent document closes
```

VRs do NOT go through: pre-review, pre-approval, release, independent post-review, independent post-approval, or independent closure.

VRs are authored interactively per Section 11. The interaction engine presents prompts from the VR template, records responses with per-entry attribution, and compiles the source into the standard VR markdown format at checkin.

### 9C.3 VR Creation

VRs are created for execution items flagged with "Yes" in the VR column of the parent document's EI table:

1. The VR column value "Yes" is a **static field** set during document drafting (planning phase)
2. During execution, the initiator creates a VR as a child of the parent document
3. The VR ID is recorded in the VR column of the EI table (replacing "Yes")
4. The VR is filled in **contemporaneously** with the verification activity — not backfilled after the fact

### 9C.4 VR Content

VRs follow the structure defined in TEMPLATE-VR:

- **Verification Identification:** Parent document, related EI(s), date
- **Verification Objective:** Capability being verified, expected outcome
- **Pre-Conditions:** System state before verification begins
- **Procedure:** Step-by-step actions performed (exact commands, not paraphrases)
- **Observations:** Actual output at each step (copy-paste, not summaries)
- **Outcome:** Positive verification (expected vs actual), negative verification (side effects), overall pass/fail
- **Signature:** Performer identity and date

### 9C.5 Evidence Standards

VR evidence must be:

- **Observational:** What was done and what was observed
- **Contemporaneous:** Recorded at the time of testing
- **Reproducible:** A person with terminal access but no project background knowledge should be able to follow the procedure and confirm matching results

VR evidence must NOT be:

- **Assertional:** Statements like "test passed" without supporting observations are insufficient

### 9C.6 VR Naming

VRs are children of their parent document:

| Parent | VR ID |
|--------|-------|
| CR-089 | CR-089-VR-001 |
| CR-089-VAR-001 | CR-089-VAR-001-VR-001 |
| CR-089-ADD-001 | CR-089-ADD-001-VR-001 |

### 9C.7 VR Parent Requirements

VRs can only be created under parents of type CR, VAR, or ADD that are in IN_EXECUTION state. The CLI enforces both constraints at creation time.

---

## 10. Post-Review Requirements

Per SOP-002 Section 7.3, a document may only be routed for post-review when:

1. **Execution Complete:** All execution items have Task Outcome of Pass, or Fail outcomes are documented via VAR (for non-test) or ER (for test documents)
2. **Blocking VARs Resolved:** All Type 1 VARs must be fully closed; Type 2 VARs must be at least pre-approved
3. **Documentation Approved:** Any controlled documents modified under the executable document are EFFECTIVE
4. **Evidence Documented:** Completion evidence is recorded in the Execution Summary column
5. **VRs Complete:** All execution items flagged with "Yes" in the VR column have an attached VR that is checked in with complete evidence per Section 9C

---

## 11. Interactive Document Authoring

Interactive templates replace freehand markdown editing for VR documents. Instead of checking out a markdown file and editing it directly, the author interacts with a structured template through the `qms interact` command. The template controls structure; the author controls content; structural conformance is guaranteed by construction.

### 11.1 Concept

An interactive template defines a state machine: each node is a **prompt** (a question the author must answer) or a **gate** (a decision point that routes the workflow). The interaction engine walks the state machine, presenting prompts in template-defined order, recording responses, and advancing the cursor. The source data compiles deterministically into the standard markdown format.

**Key principle:** The template encodes methodology and institutional knowledge. The author provides content. The system guarantees that no section is skipped, no field is left blank, and all content has per-response attribution.

### 11.2 Interactive Templates

Templates use HTML comment tags to define the state machine:

| Tag | Purpose |
|-----|---------|
| `@template` | Header: declares template name, version, and start prompt |
| `@prompt` | A prompt node: `id`, `next` (successor), optional `commit: true` |
| `@gate` | A decision node: `id`, `type: yesno`, `yes` and `no` targets |
| `@loop` / `@end-loop` | Repeating block with iteration counter `{{_n}}` |
| `@end` | Terminal node: marks document complete |

Tags are embedded in HTML comments (`<!-- @tag ... -->`) so templates remain valid markdown. Prose between tags serves as **guidance text** — instructions visible to the author during interaction but stripped from compiled output.

**No default values.** All prompts require an explicit author response. There is no `default:` attribute and no auto-accept mechanism.

### 11.3 Source Files

Interactive authoring produces three file layers:

| File | Location | Lifecycle |
|------|----------|-----------|
| `.interact` | User workspace | Active during authoring; created at checkout, removed at checkin |
| `.source.json` | `.meta/{TYPE}/` | Permanent record; stored at checkin, seeds next checkout |
| Compiled `.md` | `QMS/{TYPE}/` | Derived output; generated at checkin from source + template |

The `.interact` session file contains all authoring state: cursor position, responses, loop iterations, gate decisions, and metadata. The `.source.json` is the durable record stored alongside the document's metadata.

### 11.4 Interaction Lifecycle

**Starting:** `qms interact DOC_ID` with no flags displays the current prompt and its guidance text.

**Responding:** `qms interact DOC_ID --respond "value"` records a response and advances the cursor. File-based responses use `--respond --file path`.

**Previewing:** `qms interact DOC_ID --compile` outputs the compiled markdown to stdout for inspection. This is preview-only — it does not write to the workspace or QMS.

**Progress:** `qms interact DOC_ID --progress` shows all prompts with fill status.

**Checking in:** `qms checkin DOC_ID` compiles the source to markdown, stores `.source.json`, and removes the session file.

### 11.5 Response Model

Responses follow an **append-only** model inspired by GMP data integrity:

- Each response is stored as a list of entries, each with `value`, `author`, and `timestamp`
- Amendments append a new entry with a `reason` field — the original is never modified or deleted
- Compiled output renders superseded entries with ~~strikethrough~~ and the active entry without
- This creates a complete **amendment trail** visible in the final document

### 11.6 Engine-Managed Commits

Prompts marked with `commit: true` (typically evidence-capture prompts like "actual results") trigger automatic git commits:

1. The engine stages all changes in the project working tree
2. A commit is created with the message format: `[QMS] {DOC_ID} | {context} | {prompt_id}`
3. The resulting commit hash is recorded in the response entry

This pins the project state at the moment of observation, creating a verifiable chain between evidence and the code being verified.

### 11.7 Navigation

Authors can revisit previous prompts or reopen closed loops:

| Action | Command | Requirement |
|--------|---------|-------------|
| Amend previous response | `--goto prompt_id --reason "..."` | Must have been answered; reason required |
| Cancel amendment | `--cancel-goto` | Returns to original cursor position |
| Reopen closed loop | `--reopen loop_name --reason "..."` | Loop must be closed; reason required |

Navigation actions create amendment trail entries that are preserved in the source and visible in compiled output.

### 11.8 Applicability

VR documents use interactive authoring. Other document types remain freehand unless explicitly converted via future Change Records.

---

## 12. References

- **SOP-001:** Quality Management System - Document Control
- **SOP-002:** Change Control
- **SOP-003:** Deviation Management

---

**END OF DOCUMENT**
