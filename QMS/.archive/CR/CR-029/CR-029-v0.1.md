---
title: 'QMS CLI: Add VAR Document Type'
revision_summary: Initial draft
---

# CR-029: QMS CLI: Add VAR Document Type

## 1. Purpose

Enable the QMS CLI to support Variance Reports (VARs) as a document type, allowing proper documentation of execution variances during CR and INV execution.

---

## 2. Scope

### 2.1 Context

During execution of CR-028 (QMS CLI Qualification), it was discovered that the QMS CLI cannot create VAR documents despite TEMPLATE-VAR existing. This blocks proper QMS compliance when execution variances occur.

- **Parent Document:** CR-028 (blocked by this gap)

### 2.2 Changes Summary

- Add VAR document type to DOCUMENT_TYPES configuration
- Update schema validation for VAR document ID pattern
- Add unit tests for VAR document creation

### 2.3 Files Affected

- `qms-cli/qms_config.py` - Add VAR to DOCUMENT_TYPES
- `qms-cli/qms_schema.py` - Add validation for VAR doc ID pattern
- `qms-cli/tests/test_create.py` - Add tests for VAR document type

---

## 3. Current State

The QMS CLI supports the following document types: SOP, CR, INV, CAPA, TP, ER, RS, DS, CS, RTM, OQ, TEMPLATE.

VAR is not a supported document type despite having a template (TEMPLATE-VAR). When a CR execution encounters a variance, there is no way to create a VAR document through the CLI.

---

## 4. Proposed State

The QMS CLI supports VAR as a document type:
```python
"VAR": {"path": "CR", "executable": True, "prefix": "VAR"}
```

VARs can be created via `qms create VAR --title "..."` and follow the executable document workflow.

---

## 5. Change Description

### 5.1 VAR Document Type

Add VAR to DOCUMENT_TYPES with:
- `path: "CR"` - VARs stored under QMS/CR/ directory
- `executable: True` - VARs follow executable workflow
- `prefix: "VAR"` - Document IDs like VAR-001

Note: Parent-child nesting is not implemented in the CLI. VARs are standalone documents with naming conventions indicating their parent (e.g., a VAR for CR-028 would be titled "CR-028-VAR-001: ...").

### 5.2 Schema Updates

Update `DOC_PATTERNS` in qms_schema.py to recognize the `VAR-\d{3}` pattern.

---

## 6. Justification

- **Compliance gap:** VARs are referenced in CR template but cannot be created
- **Template parity:** TEMPLATE-VAR exists but VAR type is missing from config
- **Immediate need:** CR-028 execution requires a VAR to document a discovered issue

---

## 7. Impact Assessment

### 7.1 Files Affected

| File | Change Type | Description |
|------|-------------|-------------|
| `qms-cli/qms_config.py` | Modify | Add VAR to DOCUMENT_TYPES |
| `qms-cli/qms_schema.py` | Modify | Add VAR pattern |
| `qms-cli/tests/test_create.py` | Modify | Add test for VAR creation |

### 7.2 Documents Affected

| Document | Change Type | Description |
|----------|-------------|-------------|
| None | N/A | No QMS documents modified |

### 7.3 Other Impacts

None. This is an additive change that enables a new document type without affecting existing ones.

---

## 8. Testing Summary

- Unit test: Create VAR document, verify path and prefix
- Integration: Run full test suite to verify no regressions

---

## 9. Implementation Plan

### 9.1 Add VAR Document Type

1. Add VAR entry to DOCUMENT_TYPES in qms_config.py
2. Update qms_schema.py with VAR pattern

### 9.2 Add Tests

1. Add test case for VAR creation

### 9.3 Verify

1. Run full test suite
2. Manual verification: create VAR document

---

## 10. Execution

<!--
EXECUTION PHASE INSTRUCTIONS
============================
NOTE: Do NOT delete this comment block. It provides guidance for execution.

- Sections 1-9 are PRE-APPROVED content - do NOT modify during execution
- Only THIS TABLE and the comment sections below should be edited during execution phase

COLUMNS:
- EI: Execution item identifier
- Task Description: What to do (static, from Implementation Plan)
- Execution Summary: Narrative of what was done, evidence, observations (editable)
- Task Outcome: Pass or Fail (editable)
- Performed By - Date: Signature (editable)

TASK OUTCOME:
- Pass: Task completed as planned
- Fail: Task could not be completed as planned - attach VAR with explanation

VAR TYPES (see VAR-TEMPLATE):
- Type 1: Use when the failed task is critical to CR objectives
- Type 2: Use when impact is contained and CR can conceptually close

EXECUTION SUMMARY EXAMPLES:
- "Implemented per plan. Commit abc123."
- "Modified src/module.py:45-67. Unit tests passing."
- "Created SOP-007 (now EFFECTIVE)."
-->

| EI | Task Description | Execution Summary | Task Outcome | Performed By - Date |
|----|------------------|-------------------|--------------|---------------------|
| EI-1 | Add VAR to DOCUMENT_TYPES and schema | [SUMMARY] | [Pass/Fail] | [PERFORMER] - [DATE] |
| EI-2 | Add unit test for VAR creation | [SUMMARY] | [Pass/Fail] | [PERFORMER] - [DATE] |
| EI-3 | Run full test suite and verify | [SUMMARY] | [Pass/Fail] | [PERFORMER] - [DATE] |

<!--
NOTE: Do NOT delete this comment. It provides guidance during document execution.

Add rows as needed. When adding rows, fill columns 3-5 during execution.
-->

---

### Execution Comments

| Comment | Performed By - Date |
|---------|---------------------|
| [COMMENT] | [PERFORMER] - [DATE] |

<!--
NOTE: Do NOT delete this comment. It provides guidance during document execution.

Record observations, decisions, or issues encountered during execution.
Add rows as needed.

This section is the appropriate place to attach VARs that do not apply
to any individual execution item, but apply to the CR as a whole.
-->

---

## 11. Execution Summary

<!--
NOTE: Do NOT delete this comment. It provides guidance during document execution.

Complete this section after all EIs are executed.
Summarize the overall outcome and any deviations from the plan.
-->

[EXECUTION_SUMMARY]

---

## 12. References

- **SOP-001:** Document Control
- **SOP-002:** Change Control
- **CR-028:** QMS CLI Qualification (blocked by gap addressed here)
- **TEMPLATE-VAR:** Variance Report Template

---

**END OF DOCUMENT**
