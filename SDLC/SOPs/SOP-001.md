# SOP-001: GMP Governance Framework

**Effective Date:** 2026-01-01
**Supersedes:** Constitutional Framework of 2025-12-31

---

## 1. Purpose

This Standard Operating Procedure establishes the governance framework for the Flow State project under Good Manufacturing Practice (GMP) and Good Documentation Practice (GDocP) principles.

---

## 2. Scope

This SOP applies to all code changes, documentation updates, and process modifications within the Flow State project.

---

## 3. Leadership & Roles

| Role | Title | Responsibility |
|------|-------|----------------|
| **Lead Engineer** | The User | Project owner. Final authority on all decisions. Approves SOPs and major changes. |
| **Senior Staff Engineer** | Claude | Orchestrates sessions, spawns reviewers, implements changes, maintains documentation. |

---

## 4. The Change Review Board (CRB)

The Change Review Board is a team of specialized reviewers responsible for evaluating all code changes. Each member reviews changes within their domain of expertise.

### 4.1 CRB Composition

| Member | Abbreviation | Domain | Responsibility |
|--------|--------------|--------|----------------|
| **Quality Assurance** | QA | Process & Architecture | Enforces core principles, assigns reviewers, ensures SOP compliance |
| **TU-UI** | TU-UI | User Interface | Air Gap, Overlay Protocol, Z-ordering, widget standards |
| **TU-INPUT** | TU-INPUT | Input Handling | 4-Layer Input Chain, Modal Stack, Focus Management |
| **TU-SCENE** | TU-SCENE | Orchestration | Update Pipeline, Command Pattern, Undo/Redo integrity |
| **TU-SKETCH** | TU-SKETCH | CAD/Geometry | Domain purity, Geometric Constraints, Solver |
| **TU-SIM** | TU-SIM | Simulation | Physics, Numba optimization, Compiler bridge, DOD |
| **BU** | BU | User Experience | Usability, fun factor, product value (at QA discretion) |

### 4.2 Model Requirement

All CRB members must be spawned using the **Opus 4.5** model (`model: "opus"`).

---

## 5. Change Control Process

All code changes require a Change Record and follow a two-stage approval workflow.

### 5.1 Reviewer Assignment

| Change Scope | Required Reviewers |
|--------------|-------------------|
| All changes | QA (always required) |
| UI/Widget changes | QA + TU-UI |
| Input/Focus/Modal changes | QA + TU-INPUT |
| Orchestration/Undo changes | QA + TU-SCENE |
| CAD/Geometry changes | QA + TU-SKETCH |
| Physics/Simulation changes | QA + TU-SIM |
| Cross-domain changes | QA + all affected TUs |
| User-facing behavior changes | QA + TU(s) + BU (at QA discretion) |

QA determines reviewer assignment based on change scope and impact. For changes with no domain impact (e.g., documentation, configuration), QA may approve without TU review.

### 5.2 Two-Stage Approval

**Stage 1: Pre-Approval**
1. Change proposal is drafted (plan, impact assessment)
2. QA assigns appropriate reviewers
3. Reviewers evaluate the plan against domain standards
4. **Unanimous approval required** - all assigned reviewers must approve
5. Implementation may proceed

**Stage 2: Post-Approval**
1. Implementation is completed
2. Testing is performed per Test Protocol
3. Reviewers verify implementation matches pre-approved plan
4. **Unanimous approval required** - all assigned reviewers must confirm
5. Change is closed

### 5.3 Approval Outcomes

| Outcome | Meaning |
|---------|---------|
| **APPROVED** | All reviewers approve; proceed to next stage |
| **REJECTED** | One or more reviewers reject; revise and resubmit (comments provided) |

**There is no majority voting.** Unanimous consent of all assigned reviewers is required.

### 5.4 Escalation

If reviewers cannot reach consensus:
1. Document the disagreement in the Change Record
2. Escalate to QA for mediation
3. If unresolved, escalate to Lead Engineer for final decision

---

## 6. The Chronicle

All session transcripts are automatically captured via hooks and stored in `.claude/chronicles/`. The Chronicle serves as the institutional memory of the project.

| Directory | Purpose |
|-----------|---------|
| `.claude/chronicles/` | Automatically-generated session transcripts |
| `SDLC/` | SOPs, Change Records, Test Protocols, Requirements |

### 6.1 Session Naming Convention

Session transcripts follow the naming format:

```
Session-YYYY-MM-DD-NNN
```

Where:
- `YYYY-MM-DD` is the date (e.g., `2026-01-01`)
- `NNN` is a zero-padded sequence number for that date (e.g., `001`, `002`, `003`)

---

## 7. Document Authority

### 7.1 SOP Hierarchy

1. `CLAUDE.md` - Technical architecture guide
2. `SDLC/SOPs/SOP-001.md` - This document (governance framework)
3. `SDLC/SOPs/SOP-002.md` - Quality Assurance Requirements
4. `SDLC/SOPs/SOP-003.md` through `SOP-009.md` - Domain-specific review procedures
5. Change Records and Test Protocols in `SDLC/`

### 7.2 Amendment

The Lead Engineer may amend any SOP at any time. QA may propose amendments for Lead Engineer approval.

---

## 8. Archival Procedure

When files are retired, superseded, or preserved for historical reference, they are archived using the following procedure:

**Step 1: Create Archive Directory**
```
archive/.claude_{ProjectName}_{SessionName}/
```

Where `{ProjectName}` is the project directory name (e.g., `pipe-dream`) and `{SessionName}` is the current session identifier.

**Step 2: Mirror Directory Structure**

Recreate the file's original directory path within the archive, preserving the full path from project root.

**Step 3: Move and Rename File**

Move the file into the mirrored location, renaming it:
```
{original_file_name}_ARCHIVED.{original_file_extension}
```

---

## 9. References

- `CLAUDE.md` - Technical Architecture & Quality Management Guide
- `SOP-002` - Quality Assurance Requirements
- `.claude/chronicles/` - Session transcripts

---

*Document Control: SOP-001 v1.0*
*Effective: 2026-01-01*
